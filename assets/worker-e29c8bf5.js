(function(){"use strict";var S=function(t,a,n,r){function x(c){return c instanceof n?c:new n(function(f){f(c)})}return new(n||(n=Promise))(function(c,f){function p(i){try{l(r.next(i))}catch(u){f(u)}}function e(i){try{l(r.throw(i))}catch(u){f(u)}}function l(i){i.done?c(i.value):x(i.value).then(p,e)}l((r=r.apply(t,a||[])).next())})};let d,m,s;onmessage=function(t){t.data.canvas&&(d=t.data.canvas,b()),t.data.opts&&(m=t.data.opts,b()),t.data.tracesData&&(s=t.data.tracesData,b())};function C(t,a){let n=!1;return()=>{n||(n=!0,setTimeout(()=>{n=!1,t()},a))}}const F=1;let w=0;function k(){return S(this,void 0,void 0,function*(){if(!d||!m)return;const{margins:t,canvasWidth:a,canvasHeight:n,visibleStartTimeSec:r,visibleEndTimeSec:x,channels:c,samplingFrequency:f}=m,p=c.length;d.width=a,d.height=n;const e=d.getContext("2d");if(!e)return;w+=1;const l=w;if(e.clearRect(0,0,a,n),m.zoomInRequired&&(e.fillStyle="pink",e.textAlign="center",e.font="bold 26px Arial",e.fillText("Zoom in to view traces",a/2,n/2)),!s)return;e.save(),e.beginPath(),e.rect(t.left,t.top,a-t.left-t.right,n-t.top-t.bottom),e.clip();const i=o=>n-t.bottom-(o+.5-0)/(p-0)*(n-t.top-t.bottom),u=o=>t.left+(o/f-r)/(x-r)*(a-t.left-t.right),I=i(1)-i(0);let g=Date.now();for(let o=0;o<p;o++){if(l!==w)return;const v=s.data[o];if(!v)continue;const y=c[o],q=i(o);e.strokeStyle="black",e.beginPath();for(let h=s.startFrame;h<s.endFrame;h++){const T=u(h),D=q-(v[h-s.startFrame]-y.offset)*I/2*F*y.scale;h===s.startFrame?e.moveTo(T,D):e.lineTo(T,D)}e.stroke(),Date.now()-g>100&&(g=Date.now(),yield _(0))}})}const b=C(k,10);function _(t){return new Promise(a=>{setTimeout(a,t)})}})();
